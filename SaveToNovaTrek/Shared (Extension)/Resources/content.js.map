{
  "version": 3,
  "sources": ["../src/content.ts"],
  "sourcesContent": ["// Content script - runs on web pages in Safari\n\n// Safari uses browser API instead of chrome API\ndeclare const browser: any;\nconst chrome = typeof browser !== 'undefined' ? browser : (window as any).chrome;\n\n// Debug log\nconsole.log('[NovaTrek Extension] Content script loaded on:', window.location.href);\n\n// Function to handle received token\nfunction handleAuthToken(token: string, userId: string) {\n  console.log('[NovaTrek Extension] Handling auth token');\n  \n  // Send token to extension\n  chrome.runtime.sendMessage({\n    action: 'authTokenReceived',\n    token: token,\n    userId: userId\n  }).then(() => {\n    console.log('[NovaTrek Extension] Token sent to background');\n  }).catch(err => {\n    console.error('[NovaTrek Extension] Failed to send token:', err);\n  });\n  \n  // Store in extension storage\n  chrome.storage.local.set({ \n    authToken: token,\n    userId: userId\n  }).then(() => {\n    console.log('[NovaTrek Extension] Token stored in extension storage');\n    // Close this tab after a short delay\n    setTimeout(() => {\n      window.close();\n    }, 1000);\n  }).catch(err => {\n    console.error('[NovaTrek Extension] Failed to store token:', err);\n  });\n}\n\n// Listen for postMessage\nwindow.addEventListener('message', (event) => {\n  if (event.data && event.data.type === 'NOVATREK_AUTH_TOKEN') {\n    console.log('[NovaTrek Extension] Received token via postMessage');\n    handleAuthToken(event.data.token, event.data.userId);\n  }\n});\n\n// Listen for custom event\nwindow.addEventListener('novatrek-auth', (event: any) => {\n  if (event.detail && event.detail.token) {\n    console.log('[NovaTrek Extension] Received token via custom event');\n    handleAuthToken(event.detail.token, event.detail.userId);\n  }\n});\n\n// Listen for auth token from NovaTrek app\nif ((window.location.hostname === 'localhost' && window.location.port === '3000') || \n    window.location.hostname === 'novatrek.app') {\n  // Check if we're on the extension auth callback page\n  if (window.location.pathname === '/extension-auth') {\n    console.log('[NovaTrek Extension] Detected extension-auth page');\n    let tokenFound = false;\n    \n    // Wait for the token to be available\n    const checkForToken = setInterval(() => {\n      const tokenElement = document.getElementById('extension-auth-token');\n      console.log('[NovaTrek Extension] Checking for token element:', tokenElement);\n      \n      if (tokenElement && tokenElement.dataset.token) {\n        if (tokenFound) return; // Prevent multiple sends\n        tokenFound = true;\n        \n        clearInterval(checkForToken);\n        console.log('[NovaTrek Extension] Token found in DOM!');\n        \n        // Extract user info from the page\n        const userId = tokenElement.dataset.userId || 'demo-user';\n        \n        // Use the common handler\n        handleAuthToken(tokenElement.dataset.token, userId);\n      }\n    }, 100);\n    \n    // Stop checking after 10 seconds\n    setTimeout(() => {\n      clearInterval(checkForToken);\n    }, 10000);\n  }\n}\n\n// Add floating save button for travel-related content\nfunction detectTravelContent() {\n  const pageText = document.body.innerText.toLowerCase();\n  const travelKeywords = [\n    'hotel', 'restaurant', 'flight', 'travel', 'vacation',\n    'trip', 'tourism', 'booking', 'airbnb', 'hostel',\n    'attraction', 'museum', 'beach', 'mountain', 'city guide'\n  ];\n  \n  const isTravelContent = travelKeywords.some(keyword => pageText.includes(keyword));\n  \n  if (isTravelContent) {\n    addFloatingSaveButton();\n  }\n}\n\n// Add floating save button\nfunction addFloatingSaveButton() {\n  // Check if button already exists\n  if (document.getElementById('novatrek-save-button')) return;\n  \n  const button = document.createElement('button');\n  button.id = 'novatrek-save-button';\n  button.innerHTML = `\n    <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\">\n      <path d=\"M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z\"/>\n      <polyline points=\"17 21 17 13 7 13 7 21\"/>\n      <polyline points=\"7 3 7 8 15 8\"/>\n    </svg>\n    Save to NovaTrek\n  `;\n  \n  // Style the button\n  button.style.cssText = `\n    position: fixed;\n    bottom: 20px;\n    right: 20px;\n    z-index: 9999;\n    background: #000;\n    color: white;\n    border: none;\n    border-radius: 24px;\n    padding: 12px 20px;\n    font-size: 14px;\n    font-weight: 500;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    box-shadow: 0 4px 12px rgba(0,0,0,0.2);\n    transition: all 0.2s;\n    font-family: -apple-system, BlinkMacSystemFont, sans-serif;\n  `;\n  \n  // Hover effect\n  button.addEventListener('mouseenter', () => {\n    button.style.transform = 'scale(1.05)';\n    button.style.boxShadow = '0 6px 16px rgba(0,0,0,0.3)';\n  });\n  \n  button.addEventListener('mouseleave', () => {\n    button.style.transform = 'scale(1)';\n    button.style.boxShadow = '0 4px 12px rgba(0,0,0,0.2)';\n  });\n  \n  // Click handler\n  button.addEventListener('click', () => {\n    chrome.runtime.sendMessage({\n      action: 'save',\n      data: {\n        url: window.location.href,\n        title: document.title,\n        type: 'page'\n      }\n    });\n    \n    // Visual feedback\n    button.innerHTML = `\n      <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\">\n        <polyline points=\"20 6 9 17 4 12\"/>\n      </svg>\n      Saved!\n    `;\n    button.style.background = '#00d000';\n    \n    // Remove button after 2 seconds\n    setTimeout(() => {\n      button.remove();\n    }, 2000);\n  });\n  \n  document.body.appendChild(button);\n}\n\n// Initialize content script\nif (document.readyState === 'loading') {\n  document.addEventListener('DOMContentLoaded', detectTravelContent);\n} else {\n  detectTravelContent();\n}\n\n// Listen for text selection\nlet selectionTimeout: number;\ndocument.addEventListener('mouseup', () => {\n  clearTimeout(selectionTimeout);\n  selectionTimeout = window.setTimeout(() => {\n    const selection = window.getSelection();\n    if (selection && selection.toString().trim().length > 10) {\n      // User selected text, could show a mini save button\n      console.log('Text selected:', selection.toString());\n    }\n  }, 500);\n});"],
  "mappings": "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",
  "names": []
}
